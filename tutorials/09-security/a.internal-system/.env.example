# Identity Provider Configuration
IDP_TYPE=okta  # okta, azure, google, keycloak
IDP_DOMAIN=your-domain.okta.com  # For Okta: your-domain.okta.com, For Azure: tenant-id
IDP_CLIENT_ID=your_client_id
IDP_CLIENT_SECRET=your_client_secret
IDP_REDIRECT_URI=http://localhost:8080/callback
IDP_SCOPES=openid profile email groups

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production
JWT_ALGORITHM=HS256  # HS256 or RS256
TOKEN_EXPIRY_MINUTES=60
JWT_ISSUER=internal-rbac-proxy
JWT_AUDIENCE=internal-mcp-server

# Database Configuration
DB_TYPE=sqlite  # sqlite, postgresql, mongodb
DATABASE_URL=data/internal_system.db  # For SQLite: path, For PostgreSQL: postgresql://user:pass@host:port/db

# RBAC Configuration
ROLE_MAPPINGS_FILE=config/role_mappings.yaml
AUDIT_ENABLED=true

# Server Configuration
RBAC_PROXY_URL=http://localhost:8080
PROXY_HOST=0.0.0.0
PROXY_PORT=8080
DEBUG=false

# Optional JWKS URL (for RS256 validation)
JWKS_URL=http://localhost:8080/auth/jwks

# Example configurations for different IdPs:

# Okta Configuration:
# IDP_TYPE=okta
# IDP_DOMAIN=dev-12345.okta.com
# IDP_CLIENT_ID=0oa1a2b3c4d5e6f7g8h9
# IDP_CLIENT_SECRET=abcdef1234567890

# Azure AD Configuration:
# IDP_TYPE=azure
# IDP_DOMAIN=12345678-1234-1234-1234-123456789012  # Tenant ID
# IDP_CLIENT_ID=12345678-1234-1234-1234-123456789012
# IDP_CLIENT_SECRET=abcdef1234567890

# Google Workspace Configuration:
# IDP_TYPE=google
# IDP_DOMAIN=accounts.google.com
# IDP_CLIENT_ID=123456789012-abcdefghijklmnop.apps.googleusercontent.com
# IDP_CLIENT_SECRET=abcdef1234567890

# Keycloak Configuration:
# IDP_TYPE=keycloak
# IDP_DOMAIN=keycloak.company.com
# IDP_CLIENT_ID=internal-system-client
# IDP_CLIENT_SECRET=abcdef1234567890
